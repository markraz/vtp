<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>vtDIB.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.9.1 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>vtDIB.h</h1><div class="fragment"><pre>00001 <font class="comment">//</font>
00002 <font class="comment">// vtDIB.h</font>
00003 <font class="comment">//</font>
00004 <font class="comment">// Copyright (c) 2001 Virtual Terrain Project</font>
00005 <font class="comment">// Free for all uses, see license.txt for details.</font>
00006 <font class="comment">//</font>
00007 
00008 <font class="preprocessor">#ifndef VTDATA_DIBH</font>
00009 <font class="preprocessor"></font><font class="preprocessor">#define VTDATA_DIBH</font>
00010 <font class="preprocessor"></font>
00011 <font class="comment">// for non-Win32 systems (or code which does include the Win32 headers),</font>
00012 <font class="comment">// define some Microsoft types used by the DIB code</font>
00013 <font class="preprocessor">#ifdef _WINGDI_</font>
00014 <font class="preprocessor"></font>
00015 <font class="keyword">typedef</font> DWORD dword;
00016 
00017 <font class="preprocessor">#else</font>
00018 <font class="preprocessor"></font>
00019 <font class="keyword">typedef</font> <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> dword;
00020 <font class="keyword">typedef</font> <font class="keywordtype">unsigned</font> <font class="keywordtype">short</font> word;
00021 <font class="keyword">typedef</font> <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> byte;
00022 
00023 <font class="preprocessor">#if WIN32</font>
00024 <font class="preprocessor"></font><font class="preprocessor">#include &lt;pshpack2.h&gt;</font>
00025 <font class="preprocessor">#endif</font>
00026 <font class="preprocessor"></font>
00027 <font class="preprocessor">#ifdef __GNUC__</font>
00028 <font class="preprocessor"></font><font class="preprocessor">#  define PACKED __attribute__((packed))</font>
00029 <font class="preprocessor"></font><font class="preprocessor">#else</font>
00030 <font class="preprocessor"></font><font class="preprocessor">#  define PACKED</font>
00031 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
00032 <font class="preprocessor"></font>
00033 <font class="keyword">typedef</font> <font class="keyword">struct </font>tagBITMAPFILEHEADER {
00034     word    bfType;
00035     dword   bfSize;
00036     word    bfReserved1;
00037     word    bfReserved2;
00038     dword   bfOffBits;
00039 } PACKED BITMAPFILEHEADER;
00040 <font class="preprocessor">#if WIN32</font>
00041 <font class="preprocessor"></font><font class="preprocessor">#include &lt;poppack.h&gt;</font>
00042 <font class="preprocessor">#endif</font>
00043 <font class="preprocessor"></font>
00044 <font class="keyword">typedef</font> <font class="keyword">struct </font>tagBITMAPINFOHEADER{
00045     dword   biSize;
00046     <font class="keywordtype">long</font>    biWidth;
00047     <font class="keywordtype">long</font>    biHeight;
00048     word    biPlanes;
00049     word    biBitCount;
00050     dword   biCompression;
00051     dword   biSizeImage;
00052     <font class="keywordtype">long</font>    biXPelsPerMeter;
00053     <font class="keywordtype">long</font>    biYPelsPerMeter;
00054     dword   biClrUsed;
00055     dword   biClrImportant;
00056 } PACKED BITMAPINFOHEADER;
00057 
00058 <font class="keyword">typedef</font> <font class="keyword">struct </font>tagRGBQUAD {
00059     byte    rgbBlue;
00060     byte    rgbGreen;
00061     byte    rgbRed;
00062     byte    rgbReserved;
00063 } PACKED RGBQUAD;
00064 
00065 <font class="comment">/* constants for the biCompression field */</font>
00066 <font class="preprocessor">#define BI_RGB        0L</font>
00067 <font class="preprocessor"></font><font class="preprocessor">#define BI_RLE8       1L</font>
00068 <font class="preprocessor"></font><font class="preprocessor">#define BI_RLE4       2L</font>
00069 <font class="preprocessor"></font><font class="preprocessor">#define BI_BITFIELDS  3L</font>
00070 <font class="preprocessor"></font>
00071 <font class="preprocessor">#define RGB(r,g,b)          ((dword)(((byte)(r)|((word)((byte)(g))&lt;&lt;8))|(((dword)(byte)(b))&lt;&lt;16)))</font>
00072 <font class="preprocessor"></font>
00073 <font class="preprocessor">#define GetRValue(rgb)      ((byte)(rgb))</font>
00074 <font class="preprocessor"></font><font class="preprocessor">#define GetGValue(rgb)      ((byte)(((word)(rgb)) &gt;&gt; 8))</font>
00075 <font class="preprocessor"></font><font class="preprocessor">#define GetBValue(rgb)      ((byte)((rgb)&gt;&gt;16))</font>
00076 <font class="preprocessor"></font>
00077 <font class="preprocessor">#endif // #ifndef _WINGDI_</font>
00078 <font class="preprocessor"></font>
00079 
00080 <font class="keyword">class </font>vtDIB
00081 {
00082 <font class="keyword">public</font>:
00083     vtDIB();
00084     vtDIB(<font class="keyword">const</font> <font class="keywordtype">char</font> *fname);       <font class="comment">// load new DIB from file</font>
00085     vtDIB(<font class="keywordtype">int</font> width, <font class="keywordtype">int</font> height, <font class="keywordtype">int</font> bitdepth, <font class="keywordtype">bool</font> create_palette);    <font class="comment">// create new DIB</font>
00086     vtDIB(<font class="keywordtype">void</font> *pDIB);              <font class="comment">// wrap an existing DIB</font>
00087     ~vtDIB();
00088 
00089     <font class="keywordtype">bool</font> ReadBMP(<font class="keyword">const</font> <font class="keywordtype">char</font> *fname);
00090     <font class="keywordtype">bool</font> WriteBMP(<font class="keyword">const</font> <font class="keywordtype">char</font> *fname);
00091 <font class="comment">//  bool ReadPNG(const char *filename);</font>
00092 
00093     <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> GetPixel24(<font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y);
00094     <font class="keywordtype">void</font> SetPixel24(<font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y, dword color);
00095 
00096     <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> GetPixel8(<font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y);
00097     <font class="keywordtype">void</font> SetPixel8(<font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y, byte color);
00098 
00099     <font class="keywordtype">bool</font> GetPixel1(<font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y);
00100     <font class="keywordtype">void</font> SetPixel1(<font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y, <font class="keywordtype">bool</font> color);
00101 
00102     <font class="keywordtype">int</font> GetWidth()<font class="keyword"> </font>{ <font class="keywordflow">return</font> m_iWidth; }
00103     <font class="keywordtype">int</font> GetHeight()<font class="keyword"> </font>{ <font class="keywordflow">return</font> m_iHeight; }
00104     <font class="keywordtype">int</font> GetDepth()<font class="keyword"> </font>{ <font class="keywordflow">return</font> m_iBitCount; }
00105 
00106     <font class="keywordtype">void</font> *GetHandle()<font class="keyword"> </font>{ <font class="keywordflow">return</font> m_pDIB; }
00107     BITMAPINFOHEADER *GetDIBHeader()<font class="keyword"> </font>{ <font class="keywordflow">return</font> m_Hdr; }
00108     <font class="keywordtype">void</font> *GetDIBData()<font class="keyword"> </font>{ <font class="keywordflow">return</font> m_Data; }
00109 
00110     <font class="keywordtype">void</font> Lock();
00111     <font class="keywordtype">void</font> Unlock();
00112     <font class="keywordtype">void</font> LeaveInternalDIB(<font class="keywordtype">bool</font> bLeaveIt);
00113 
00114     <font class="keywordtype">bool</font>    m_bLoadedSuccessfully;
00115 
00116 <font class="keyword">private</font>:
00117     <font class="keywordtype">void</font> ComputeByteWidth();
00118 
00119     <font class="keywordtype">bool</font>    m_bLeaveIt;
00120 
00121     <font class="comment">// When locked, these two fields point to the header and data</font>
00122     BITMAPINFOHEADER *m_Hdr;
00123     <font class="keywordtype">void</font>    *m_Data;
00124 
00125     <font class="keywordtype">void</font>    *m_pDIB;
00126     <font class="keywordtype">int</font>     m_iWidth, m_iHeight, m_iBitCount;
00127     <font class="keywordtype">int</font>     m_iByteWidth;
00128     <font class="keywordtype">int</font>     m_iPaletteSize;
00129 };
00130 
00131 <font class="preprocessor">#endif</font>
</font></pre></div><hr><address><small>Generated at Sun Oct 7 23:42:35 2001 for vtdata library by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.9.1 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>

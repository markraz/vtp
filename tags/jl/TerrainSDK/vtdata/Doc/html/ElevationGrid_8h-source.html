<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ElevationGrid.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.9.1 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>ElevationGrid.h</h1><div class="fragment"><pre>00001 <font class="comment">//</font>
00002 <font class="comment">// vtElevationGrid.h</font>
00003 <font class="comment">//</font>
00004 <font class="comment">// Copyright (c) 2001 Virtual Terrain Project.</font>
00005 <font class="comment">// Free for all uses, see license.txt for details.</font>
00006 <font class="comment">//</font>
00007 
00008 <font class="preprocessor">#ifndef ELEVATIONGRIDH</font>
00009 <font class="preprocessor"></font><font class="preprocessor">#define ELEVATIONGRIDH</font>
00010 <font class="preprocessor"></font>
00011 <font class="preprocessor">#include &lt;limits.h&gt;</font>         <font class="comment">// for SHRT_MIN</font>
00012 <font class="preprocessor">#include "MathTypes.h"</font>
00013 <font class="preprocessor">#include "Projections.h"</font>
00014 
00015 <font class="keyword">class </font>vtDIB;
00016 
00017 <font class="preprocessor">#define INVALID_ELEVATION   SHRT_MIN</font>
00018 <font class="preprocessor"></font>
<a name="l00029"></a><a class="code" href="classvtElevationGrid.html">00029</a> <font class="keyword">class </font><a class="code" href="classvtElevationGrid.html">vtElevationGrid</a>
00030 {
00031 <font class="keyword">public</font>:
00032     <a class="code" href="classvtElevationGrid.html#a0">vtElevationGrid</a>();
00033     <a class="code" href="classvtElevationGrid.html#a0">vtElevationGrid</a>(DRECT area, <font class="keywordtype">int</font> iColumns, <font class="keywordtype">int</font> iRows, <font class="keywordtype">bool</font> bFloat, <a class="code" href="classvtProjection.html">vtProjection</a> proj);
00034     <a class="code" href="classvtElevationGrid.html#a2">~vtElevationGrid</a>();
00035 
00036     <font class="keywordtype">bool</font> <a class="code" href="classvtElevationGrid.html#a3">ConvertProjection</a>(<a class="code" href="classvtElevationGrid.html">vtElevationGrid</a> *pOld, <a class="code" href="classvtProjection.html">vtProjection</a> &amp;NewProj, <font class="keywordtype">void</font> progress_callback(<font class="keywordtype">int</font>) = NULL);
00037 
00038     <font class="comment">// Load</font>
00039     <font class="keywordtype">bool</font> <a class="code" href="classvtElevationGrid.html#a4">LoadFromDEM</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> *szFileName, <font class="keywordtype">void</font> progress_callback(<font class="keywordtype">int</font>) = NULL);
00040     <font class="keywordtype">bool</font> <a class="code" href="classvtElevationGrid.html#a5">LoadFromASC</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> *szFileName, <font class="keywordtype">void</font> progress_callback(<font class="keywordtype">int</font>) = NULL);
00041     <font class="keywordtype">bool</font> <a class="code" href="classvtElevationGrid.html#a6">LoadFromTerragen</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> *szFileName, <font class="keywordtype">void</font> progress_callback(<font class="keywordtype">int</font>) = NULL);
00042     <font class="keywordtype">bool</font> <a class="code" href="classvtElevationGrid.html#a7">LoadFromCDF</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> *szFileName, <font class="keywordtype">void</font> progress_callback(<font class="keywordtype">int</font>) = NULL);
00043     <font class="keywordtype">bool</font> <a class="code" href="classvtElevationGrid.html#a8">LoadFromDTED</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> *szFileName, <font class="keywordtype">void</font> progress_callback(<font class="keywordtype">int</font>) = NULL);
00044     <font class="keywordtype">bool</font> <a class="code" href="classvtElevationGrid.html#a9">LoadFromGTOPO30</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> *szFileName, <font class="keywordtype">void</font> progress_callback(<font class="keywordtype">int</font>) = NULL);
00045     <font class="keywordtype">bool</font> <a class="code" href="classvtElevationGrid.html#a10">LoadFromGRD</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> *szFileName, <font class="keywordtype">void</font> progress_callback(<font class="keywordtype">int</font>) = NULL);
00046     <font class="keywordtype">bool</font> <a class="code" href="classvtElevationGrid.html#a11">LoadFromPGM</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> *szFileName, <font class="keywordtype">void</font> progress_callback(<font class="keywordtype">int</font>) = NULL);
00047     <font class="keywordtype">bool</font> <a class="code" href="classvtElevationGrid.html#a12">LoadFromRAW</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> *szFileName, <font class="keywordtype">int</font> width, <font class="keywordtype">int</font> height,
00048         <font class="keywordtype">int</font> bytes_per_element, <font class="keywordtype">float</font> vertical_units);
00049     <font class="keywordtype">bool</font> <a class="code" href="classvtElevationGrid.html#a13">LoadFromBT</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> *szFileName, <font class="keywordtype">void</font> progress_callback(<font class="keywordtype">int</font>) = NULL);
00050     <font class="keywordtype">bool</font> <a class="code" href="classvtElevationGrid.html#a14">LoadBTHeader</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> *szFileName);
00051 
00052     <font class="comment">// Use GDAL to read a file</font>
00053     <font class="keywordtype">bool</font> <a class="code" href="classvtElevationGrid.html#a15">LoadWithGDAL</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> *szFileName, <font class="keywordtype">void</font> progress_callback(<font class="keywordtype">int</font>));
00054 
00055     <font class="comment">// Save</font>
00056     <font class="keywordtype">bool</font> <a class="code" href="classvtElevationGrid.html#a16">SaveToTerragen</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> *szFileName);
00057     <font class="keywordtype">bool</font> <a class="code" href="classvtElevationGrid.html#a17">SaveToBT</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> *szFileName, <font class="keywordtype">void</font> progress_callback(<font class="keywordtype">int</font>) = NULL);
00058 
00059     <font class="keywordtype">void</font> <a class="code" href="classvtElevationGrid.html#a18">ComputeHeightExtents</a>();
00060     <font class="keywordtype">void</font> <a class="code" href="classvtElevationGrid.html#a19">GetHeightExtents</a>(<font class="keywordtype">float</font> &amp;fMinHeight, <font class="keywordtype">float</font> &amp;fMaxHeight);
00061     <font class="keywordtype">void</font> <a class="code" href="classvtElevationGrid.html#a20">GetDimensions</a>(<font class="keywordtype">int</font> &amp;nColumns, <font class="keywordtype">int</font> &amp;nRows);
00062     DPoint2 <a class="code" href="classvtElevationGrid.html#a21">GetSpacing</a>();
00063 
<a name="l00066"></a><a class="code" href="classvtElevationGrid.html#a22">00066</a>     <font class="keywordtype">bool</font> <a class="code" href="classvtElevationGrid.html#a22">ContainsPoint</a>(<font class="keywordtype">float</font> x, <font class="keywordtype">float</font> y)<font class="keyword"></font>
00067 <font class="keyword">    </font>{
00068         <font class="keywordflow">return</font> (m_area.left &lt; x &amp;&amp; x &lt; m_area.right &amp;&amp;
00069                 m_area.bottom &lt; y &amp;&amp; y &lt; m_area.top);
00070     }
00071 
00072     <font class="comment">// Set/Get height values</font>
00073     <font class="keywordtype">void</font>  <a class="code" href="classvtElevationGrid.html#a23">SetFValue</a>(<font class="keywordtype">int</font> i, <font class="keywordtype">int</font> j, <font class="keywordtype">float</font> value);
00074     <font class="keywordtype">void</font>  <a class="code" href="classvtElevationGrid.html#a24">SetValue</a>(<font class="keywordtype">int</font> i, <font class="keywordtype">int</font> j, <font class="keywordtype">short</font> value);
00075     <font class="keywordtype">int</font>   <a class="code" href="classvtElevationGrid.html#a25">GetValue</a>(<font class="keywordtype">int</font> i, <font class="keywordtype">int</font> j);   <font class="comment">// returns height value as a integer</font>
00076     <font class="keywordtype">float</font> <a class="code" href="classvtElevationGrid.html#a26">GetFValue</a>(<font class="keywordtype">int</font> i, <font class="keywordtype">int</font> j);  <font class="comment">// returns height value as a float</font>
00077 
00078     <font class="keywordtype">float</font> <a class="code" href="classvtElevationGrid.html#a27">GetClosestValue</a>(<font class="keywordtype">double</font> x, <font class="keywordtype">double</font> y);
00079     <font class="keywordtype">float</font> <a class="code" href="classvtElevationGrid.html#a28">GetFilteredValue</a>(<font class="keywordtype">double</font> x, <font class="keywordtype">double</font> y);
00080 
00081     <font class="comment">// Accessors</font>
<a name="l00083"></a><a class="code" href="classvtElevationGrid.html#a29">00083</a>     <font class="keywordtype">char</font> *<a class="code" href="classvtElevationGrid.html#a29">GetDEMName</a>()<font class="keyword">  </font>{ <font class="keywordflow">return</font> m_szOriginalDEMName; }
00084 
<a name="l00086"></a><a class="code" href="classvtElevationGrid.html#a30">00086</a>     DRECT &amp;<a class="code" href="classvtElevationGrid.html#a30">GetGridExtents</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> m_area; }
00087 
00089     DRECT <a class="code" href="classvtElevationGrid.html#a31">GetAreaExtents</a>();
00090 
<a name="l00092"></a><a class="code" href="classvtElevationGrid.html#a32">00092</a>     <font class="keywordtype">void</font> <a class="code" href="classvtElevationGrid.html#a32">SetGridExtents</a>(DRECT &amp;ext)<font class="keyword"> </font>{ m_area = ext; }
00093 
<a name="l00097"></a><a class="code" href="classvtElevationGrid.html#a33">00097</a>     <font class="keywordtype">bool</font>  <a class="code" href="classvtElevationGrid.html#a33">IsFloatMode</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> m_bFloatMode; }
00098 
00099     <font class="keywordtype">void</font> <a class="code" href="classvtElevationGrid.html#a34">ColorDibFromElevation1</a>(vtDIB *pDIB, RGBi color_ocean);
00100 
00101     <a class="code" href="classvtProjection.html">vtProjection</a> &amp;GetProjection()<font class="keyword"> </font>{ <font class="keywordflow">return</font> m_proj; }
00102 
00103     <font class="keywordtype">void</font> GetCorners(DLine2 &amp;line, <font class="keywordtype">bool</font> bGeo);
00104     <font class="keywordtype">void</font> SetCorners(DLine2 &amp;line);
00105 
00106 <font class="keyword">protected</font>:
00107     DRECT   m_area;     <font class="comment">// bounds in the original data space</font>
00108     <font class="keywordtype">int</font>     m_iColumns;
00109     <font class="keywordtype">int</font>     m_iRows;
00110     <font class="keywordtype">bool</font>    m_bFloatMode;
00111     <font class="keywordtype">short</font>   *m_pData;
00112     <font class="keywordtype">float</font>   *m_pFData;
00113 
00114     <font class="keywordtype">void</font> <a class="code" href="classvtElevationGrid.html#b0">ComputeExtentsFromCorners</a>();
00115     <font class="keywordtype">void</font> <a class="code" href="classvtElevationGrid.html#b1">ComputeCornersFromExtents</a>();
00116 
00117     DPoint2     m_Corners[4];       <font class="comment">// data corners, in the projection of this terrain</font>
00118 
00119     <a class="code" href="classvtProjection.html">vtProjection</a>    m_proj;
00120 
00121 <font class="keyword">private</font>:
00122     <font class="comment">// minimum and maximum height values for the whole grid</font>
00123     <font class="keywordtype">float</font>   m_fMinHeight, m_fMaxHeight;
00124     <font class="keywordtype">char</font>    m_szOriginalDEMName[41];
00125 
00126     <font class="keywordtype">void</font>    AllocateArray();
00127 
00128     <font class="comment">// only used by DEM reader code</font>
00129     <font class="keywordtype">double</font>  m_fVMeters;
00130     <font class="keywordtype">double</font>  m_fGRes;
00131     <font class="keywordtype">int</font>     m_iDataSize;
00132 };
00133 
00135 
00136 <font class="comment">//  Header structure for a GTOPO30 DEM header file</font>
00137 <font class="keyword">typedef</font> <font class="keyword">struct</font>
00138 {
00139     <font class="keywordtype">char</font>            ByteOrder[30];      <font class="comment">//  Byte order in which image pixel values are stored</font>
00140                                         <font class="comment">//      M = Motorola byte order (MSB first)</font>
00141     <font class="keywordtype">char</font>            Layout[30];         <font class="comment">//  Organization of the bands in the file</font>
00142                                         <font class="comment">//      BIL = Band interleaved by line (DEM = single band image)</font>
00143     <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font>   NumRows;            <font class="comment">//  Number of rows in the image</font>
00144     <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font>   NumCols;            <font class="comment">//  Number of columns in the image</font>
00145     <font class="keywordtype">char</font>            Bands[30];          <font class="comment">//  Number of spectral bands in the image (1 for DEM)</font>
00146     <font class="keywordtype">char</font>            Bits[30];           <font class="comment">//  Number of bits per pixel (16 for DEM)</font>
00147     <font class="keywordtype">char</font>            BandRowBytes[30];   <font class="comment">//  Number of bytes per band per row</font>
00148                                         <font class="comment">//      (twice the number of columns for 16 bit DEM)</font>
00149     <font class="keywordtype">char</font>            TotalRowBytes[30];  <font class="comment">//  Total number of bytes of data per row</font>
00150                                         <font class="comment">//      (twice the number of columns for 16 bit DEM)</font>
00151     <font class="keywordtype">char</font>            BandGapBytes[30];   <font class="comment">//  Number of bytes between bands in a BSQ format</font>
00152                                         <font class="comment">//      (0 for DEM)</font>
00153     <font class="keywordtype">short</font>           NoData;             <font class="comment">//  Value used for no data or masking purposes</font>
00154     <font class="keywordtype">double</font>          ULXMap;             <font class="comment">//  Longitude of the center of the upper left pixel in decimal degrees.</font>
00155     <font class="keywordtype">double</font>          ULYMap;             <font class="comment">//  Latitude of the center of the upper left pixel in decimal degrees.</font>
00156     <font class="keywordtype">double</font>          XDim;               <font class="comment">//  x dimension of a pixel in geographic units (decimal degrees).</font>
00157     <font class="keywordtype">double</font>          YDim;               <font class="comment">//  y dimension of a pixel in geographic units (decimal degrees).</font>
00158 } GTOPOHeader;
00159 
00160 <font class="preprocessor">#ifndef max</font>
00161 <font class="preprocessor"></font><font class="preprocessor">#define max(a,b)            (((a) &gt; (b)) ? (a) : (b))</font>
00162 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
00163 <font class="preprocessor"></font>
00164 <font class="preprocessor">#ifndef min</font>
00165 <font class="preprocessor"></font><font class="preprocessor">#define min(a,b)            (((a) &lt; (b)) ? (a) : (b))</font>
00166 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
00167 <font class="preprocessor"></font>
00168 <font class="preprocessor">#endif  // ELEVATIONGRIDH</font>
00169 <font class="preprocessor"></font>
</pre></div><hr><address><small>Generated at Sun Oct 7 23:42:35 2001 for vtdata library by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.9.1 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
